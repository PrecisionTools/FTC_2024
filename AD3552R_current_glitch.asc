Version 4
SHEET 1 3092 740
WIRE 2176 -544 2048 -544
WIRE 2048 -480 2048 -544
WIRE 2000 -464 1776 -464
WIRE -368 -384 -432 -384
WIRE -288 -384 -368 -384
WIRE -48 -384 -128 -384
WIRE 16 -384 -48 -384
WIRE 272 -384 160 -384
WIRE 640 -384 272 -384
WIRE 2000 -384 2000 -416
WIRE 2048 -384 2048 -400
WIRE 2048 -384 2000 -384
WIRE 832 -368 704 -368
WIRE 960 -368 832 -368
WIRE 1104 -368 960 -368
WIRE 1280 -368 1200 -368
WIRE 1360 -368 1280 -368
WIRE 2048 -352 2048 -384
WIRE 160 -336 160 -384
WIRE 640 -336 592 -336
WIRE 960 -320 960 -368
WIRE 992 -320 960 -320
WIRE 1104 -320 1040 -320
WIRE 1360 -288 1360 -368
WIRE 1392 -288 1360 -288
WIRE 1776 -288 1776 -464
WIRE 1520 -272 1456 -272
WIRE -208 -256 -208 -304
WIRE -208 -256 -432 -256
WIRE 1104 -256 1104 -288
WIRE 1392 -224 1360 -224
WIRE 160 -208 160 -256
WIRE 1408 -176 1408 -224
WIRE 1776 -144 1776 -208
WIRE 272 -128 160 -128
WIRE 640 -128 272 -128
WIRE 848 -128 704 -128
WIRE 960 -128 848 -128
WIRE 1104 -128 960 -128
WIRE 1280 -128 1200 -128
WIRE 1360 -128 1360 -224
WIRE 1360 -128 1280 -128
WIRE 592 -96 592 -336
WIRE 640 -96 592 -96
WIRE 960 -80 960 -128
WIRE 992 -80 960 -80
WIRE 1104 -80 1040 -80
WIRE 160 -48 160 -128
WIRE 1104 -16 1104 -48
WIRE 1776 -16 1776 -64
WIRE 160 80 160 32
WIRE 1904 128 1872 128
WIRE 2016 128 1984 128
WIRE 2144 128 2016 128
WIRE 272 160 160 160
WIRE 592 160 592 -96
WIRE 592 160 272 160
WIRE 2016 192 2016 128
WIRE 160 272 160 160
WIRE 2016 336 2016 272
WIRE 160 400 160 352
FLAG -432 -384 code
IOPIN -432 -384 In
FLAG -432 -256 SCLK
IOPIN -432 -256 In
FLAG 272 -384 pos_chg
FLAG -48 -384 last_code
FLAG 160 -208 0
FLAG 272 -128 neg_chg
FLAG 160 80 0
FLAG 160 400 0
FLAG 272 160 code_match
FLAG 832 -368 pos_glitch_trig
FLAG 848 -128 neg_glitch_trig
FLAG 2144 128 OUT
IOPIN 2144 128 Out
FLAG 1776 -16 0
FLAG 1104 -256 0
FLAG 1280 -368 pos_enable
FLAG 1104 -16 0
FLAG 1280 -128 neg_enable
FLAG 1872 128 IN
IOPIN 1872 128 In
FLAG 2176 -544 glitch
IOPIN 2176 -544 Out
FLAG -368 -384 code
FLAG 1520 -272 trigger
IOPIN 1520 -272 Out
FLAG 1408 -176 0
FLAG 2048 -352 0
FLAG 2016 336 0
SYMBOL tap_register -208 -352 R0
SYMATTR InstName X1
SYMBOL bv 160 -352 R0
SYMATTR InstName B1
SYMATTR Value V=buf(V(code,last_code))
SYMBOL bv 160 -64 R0
SYMATTR InstName B2
SYMATTR Value V=buf(V(last_code, code))
SYMBOL bv 160 256 R0
SYMATTR InstName B3
SYMATTR Value V=inv(V(code)-offset-int((V(code)-offset)/period)*period)
SYMBOL Digital\\and 672 -416 R0
SYMATTR InstName A1
SYMBOL Digital\\and 672 -176 R0
SYMATTR InstName A2
SYMBOL voltage 1776 -304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 45 54 Left 2
SYMATTR Value PWL(0 0 +{Td} {A} +{Td} {-A} +{Td} 0) TRIGGER V(pos_enable)
SYMATTR InstName V1
SYMBOL Digital\\srflop 1152 -416 R0
SYMATTR InstName A3
SYMBOL Digital\\srflop 1152 -176 R0
SYMATTR InstName A4
SYMBOL voltage 1776 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 43 60 Left 2
SYMATTR Value PWL(0 0 +{Td} {-A} +{Td} {A} +{Td} 0) TRIGGER V(neg_enable)
SYMATTR InstName V2
SYMBOL Digital\\or 1424 -320 R0
SYMATTR InstName A5
SYMBOL e 2048 -496 R0
SYMATTR InstName E1
SYMATTR Value {amplitude}
SYMBOL bi 2016 192 R0
SYMATTR InstName B5
SYMATTR Value I=V(glitch)
SYMBOL res 2000 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1µ
SYMBOL bDelay 1024 -320 R0
SYMATTR InstName X2
SYMATTR SpiceLine2 t={duration}
SYMBOL bDelay 1024 -80 R0
SYMATTR InstName X3
SYMATTR SpiceLine2 t={duration}
TEXT 328 -584 Left 2 !.param offset = 0\n.param period = 8\n.param amplitude = 1
TEXT 968 -520 Left 2 !.param duration = Td*3
TEXT 1784 -560 Left 2 !.param Td = 15n\n.param A = 2u
