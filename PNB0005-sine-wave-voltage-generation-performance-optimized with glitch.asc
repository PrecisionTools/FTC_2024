Version 4
SHEET 1 7056 3444
WIRE 4464 -64 4448 -64
WIRE 4656 -64 4464 -64
WIRE 4848 -64 4736 -64
WIRE 4992 -64 4912 -64
WIRE 5088 -64 4992 -64
WIRE 5424 -64 5168 -64
WIRE 5424 -32 5424 -64
WIRE 4448 -16 4448 -64
WIRE 4448 80 4448 64
WIRE 5424 80 5424 48
WIRE 2944 288 2928 288
WIRE 3152 288 3136 288
WIRE 3376 288 3344 288
WIRE 2928 320 2928 288
WIRE 3136 320 3136 288
WIRE 3344 320 3344 288
WIRE 4656 320 4624 320
WIRE 4928 320 4896 320
WIRE 5200 320 5168 320
WIRE 4624 352 4624 320
WIRE 4896 352 4896 320
WIRE 5168 352 5168 320
WIRE 2928 416 2928 400
WIRE 3136 416 3136 400
WIRE 3344 416 3344 400
WIRE 3344 416 3312 416
WIRE 2944 464 2928 464
WIRE 3152 464 3136 464
WIRE 4624 480 4624 432
WIRE 4896 480 4896 432
WIRE 5168 480 5168 432
WIRE 2928 496 2928 464
WIRE 3136 496 3136 464
WIRE 2928 592 2928 576
WIRE 3136 592 3136 576
WIRE 3472 1280 3440 1280
WIRE 3712 1280 3552 1280
WIRE 3776 1280 3712 1280
WIRE 3824 1280 3776 1280
WIRE 3968 1280 3904 1280
WIRE 4016 1280 3968 1280
WIRE 3648 1312 3632 1312
WIRE 3648 1328 3648 1312
WIRE 3552 1392 3488 1392
WIRE 3488 1408 3488 1392
WIRE 3776 1424 3776 1280
WIRE 3776 1424 3744 1424
WIRE 3552 1456 3488 1456
WIRE 816 1504 560 1504
WIRE 1984 1504 816 1504
WIRE 2144 1504 1984 1504
WIRE 3904 1504 3888 1504
WIRE 3552 1520 3520 1520
WIRE 3904 1520 3904 1504
WIRE 4800 1520 4400 1520
WIRE 4912 1520 4800 1520
WIRE 4992 1520 4912 1520
WIRE 3872 1536 3792 1536
WIRE 4016 1552 4016 1280
WIRE 4016 1552 3936 1552
WIRE 4800 1552 4800 1520
WIRE 624 1568 624 1552
WIRE 3872 1568 3824 1568
WIRE 560 1584 560 1504
WIRE 592 1584 560 1584
WIRE 4400 1584 4400 1520
WIRE 752 1600 656 1600
WIRE 816 1600 752 1600
WIRE 1984 1600 816 1600
WIRE 2048 1600 1984 1600
WIRE 3904 1600 3904 1584
WIRE 3904 1600 3888 1600
WIRE -1056 1616 -1072 1616
WIRE -1024 1616 -1056 1616
WIRE -976 1616 -1024 1616
WIRE -528 1616 -688 1616
WIRE -448 1616 -528 1616
WIRE 32 1616 -448 1616
WIRE 480 1616 32 1616
WIRE 592 1616 480 1616
WIRE 5216 1616 5216 1600
WIRE 752 1632 752 1600
WIRE -528 1648 -528 1616
WIRE -448 1648 -448 1616
WIRE 624 1648 624 1632
WIRE 4896 1648 4880 1648
WIRE 2048 1664 2048 1600
WIRE 2144 1664 2144 1504
WIRE 2224 1664 2224 1616
WIRE 3584 1664 3584 1632
WIRE 3584 1664 3568 1664
WIRE 3712 1664 3712 1632
WIRE 4896 1664 4896 1648
WIRE -1024 1680 -1024 1616
WIRE -976 1680 -1024 1680
WIRE -960 1680 -976 1680
WIRE -656 1680 -688 1680
WIRE -624 1680 -656 1680
WIRE 4800 1680 4800 1616
WIRE 4864 1680 4800 1680
WIRE -624 1696 -624 1680
WIRE 4992 1696 4992 1520
WIRE 4992 1696 4928 1696
WIRE 5024 1696 4992 1696
WIRE 5104 1696 5024 1696
WIRE 5360 1696 5328 1696
WIRE 5392 1696 5360 1696
WIRE 3520 1712 3520 1520
WIRE 3552 1712 3520 1712
WIRE 4016 1712 4016 1552
WIRE 4096 1712 4016 1712
WIRE 4224 1712 4176 1712
WIRE 4272 1712 4224 1712
WIRE 4400 1712 4400 1648
WIRE 4400 1712 4352 1712
WIRE 4464 1712 4400 1712
WIRE 4608 1712 4544 1712
WIRE 4688 1712 4608 1712
WIRE 4864 1712 4688 1712
WIRE 5024 1712 5024 1696
WIRE -528 1728 -528 1712
WIRE -448 1728 -448 1712
WIRE 3200 1728 2992 1728
WIRE -832 1744 -832 1712
WIRE 32 1744 32 1616
WIRE 64 1744 32 1744
WIRE 288 1744 256 1744
WIRE 752 1744 752 1696
WIRE 3488 1744 3488 1456
WIRE 3792 1744 3792 1536
WIRE 3792 1744 3488 1744
WIRE 3840 1744 3792 1744
WIRE 4016 1744 4016 1712
WIRE 4016 1744 3904 1744
WIRE 4896 1744 4896 1728
WIRE 4896 1744 4880 1744
WIRE 5104 1760 5072 1760
WIRE -624 1776 -624 1760
WIRE 3072 1792 3072 1776
WIRE 3648 1792 3632 1792
WIRE 4224 1792 4224 1712
WIRE 64 1808 32 1808
WIRE 288 1808 288 1744
WIRE 288 1808 256 1808
WIRE 2992 1808 2992 1728
WIRE 3040 1808 2992 1808
WIRE 3648 1808 3648 1792
WIRE 4608 1808 4608 1712
WIRE 3200 1824 3200 1728
WIRE 3200 1824 3104 1824
WIRE 3296 1824 3200 1824
WIRE 3440 1824 3440 1280
WIRE 3440 1824 3296 1824
WIRE 4800 1824 4800 1680
WIRE 4896 1824 4800 1824
WIRE 5024 1824 5024 1792
WIRE 5024 1824 4896 1824
WIRE 5104 1824 5024 1824
WIRE 5360 1824 5360 1696
WIRE 5360 1824 5328 1824
WIRE 32 1840 32 1808
WIRE 32 1840 -224 1840
WIRE 992 1840 848 1840
WIRE 1024 1840 992 1840
WIRE 1472 1840 1216 1840
WIRE 1712 1840 1632 1840
WIRE 1952 1840 1872 1840
WIRE 2000 1840 1952 1840
WIRE 2464 1840 2416 1840
WIRE 2560 1840 2464 1840
WIRE 2976 1840 2896 1840
WIRE 3040 1840 2976 1840
WIRE 3824 1840 3824 1568
WIRE 3888 1840 3824 1840
WIRE 3920 1840 3888 1840
WIRE 32 1872 32 1840
WIRE 64 1872 32 1872
WIRE 288 1872 256 1872
WIRE 2496 1872 2464 1872
WIRE 2560 1872 2496 1872
WIRE 3072 1872 3072 1856
WIRE 3552 1872 3488 1872
WIRE 3488 1888 3488 1872
WIRE 5072 1888 5072 1760
WIRE 5072 1888 4976 1888
WIRE 5104 1888 5072 1888
WIRE 5376 1888 5328 1888
WIRE 5440 1888 5376 1888
WIRE 5504 1888 5440 1888
WIRE 848 1904 848 1840
WIRE 1024 1904 960 1904
WIRE 1248 1904 1216 1904
WIRE 1280 1904 1248 1904
WIRE 1472 1904 1424 1904
WIRE 1680 1904 1632 1904
WIRE 1712 1904 1680 1904
WIRE 2560 1904 2432 1904
WIRE 2992 1904 2896 1904
WIRE 3024 1904 2992 1904
WIRE 3808 1904 3744 1904
WIRE 4224 1904 4224 1856
WIRE 4608 1904 4608 1872
WIRE 5440 1904 5440 1888
WIRE 960 1920 960 1904
WIRE 3808 1920 3808 1904
WIRE 64 1936 32 1936
WIRE 288 1936 288 1872
WIRE 288 1936 256 1936
WIRE 3552 1936 3488 1936
WIRE -224 1952 -224 1840
WIRE -64 1952 -224 1952
WIRE -64 1968 -64 1952
WIRE 736 1984 736 1936
WIRE 960 1984 960 1920
WIRE 5376 1984 5376 1888
WIRE 3552 2000 3520 2000
WIRE -144 2016 -160 2016
WIRE -144 2032 -144 2016
WIRE 160 2032 160 1984
WIRE 848 2032 848 1984
WIRE 3808 2032 3808 2000
WIRE 5168 2032 5168 2016
WIRE 5440 2032 5440 1984
WIRE -224 2048 -224 1952
WIRE -176 2048 -224 2048
WIRE 624 2048 624 2032
WIRE -64 2064 -64 2032
WIRE -64 2064 -112 2064
WIRE 32 2064 32 1936
WIRE 32 2064 -64 2064
WIRE 480 2064 32 2064
WIRE 592 2064 480 2064
WIRE -176 2080 -224 2080
WIRE 736 2080 736 2048
WIRE 736 2080 656 2080
WIRE 816 2080 736 2080
WIRE 1984 2080 816 2080
WIRE 2048 2080 2048 2016
WIRE 2048 2080 1984 2080
WIRE 5264 2080 5264 2016
WIRE 5376 2080 5376 2048
WIRE 592 2096 560 2096
WIRE 2224 2096 2224 2016
WIRE 2288 2096 2288 2016
WIRE -144 2112 -144 2096
WIRE -144 2112 -160 2112
WIRE 960 2112 960 2064
WIRE -224 2128 -224 2080
WIRE 624 2128 624 2112
WIRE 3808 2128 3808 2080
WIRE 3584 2144 3584 2112
WIRE 3584 2144 3568 2144
WIRE 3712 2144 3712 2112
WIRE 560 2176 560 2096
WIRE 816 2176 560 2176
WIRE 1984 2176 816 2176
WIRE 2144 2176 2144 2016
WIRE 2144 2176 1984 2176
WIRE 3520 2192 3520 2000
WIRE 3552 2192 3520 2192
WIRE 1248 2224 1248 1904
WIRE 2064 2224 1248 2224
WIRE 2432 2224 2432 1904
WIRE 2432 2224 2064 2224
WIRE 3488 2224 3488 1936
WIRE 3808 2224 3808 2192
WIRE 3808 2224 3488 2224
WIRE 3920 2224 3920 1840
WIRE 3920 2224 3808 2224
FLAG 2928 416 0
FLAG 3136 416 0
FLAG 3152 288 Vdd
FLAG 2944 288 Vss
FLAG 4624 480 0
FLAG 3072 1776 Vdd
FLAG 3072 1872 Vss
FLAG 624 1552 Vdd
FLAG 624 1648 Vss
FLAG 480 2064 VrefM5V
FLAG 624 2128 Vdd
FLAG 624 2032 Vss
FLAG 480 1616 VrefP5V
FLAG 1984 2080 VREFNF
FLAG 1984 2176 VREFNS
FLAG 1984 1600 VREFPF
FLAG 1984 1504 VREFPS
FLAG 736 1936 0
FLAG 752 1744 0
FLAG 2288 2096 0
FLAG 2224 1616 Vdd
FLAG 2224 2096 Vss
FLAG 4656 320 ADG5421F_IN
FLAG 4896 480 0
FLAG 4928 320 ADG5421F_POC
FLAG 816 2080 VREFNF
FLAG 816 2176 VREFNS
FLAG 816 1600 VREFPF
FLAG 816 1504 VREFPS
FLAG -224 2128 0
FLAG 3312 416 Vdd
FLAG 3376 288 VddR
FLAG 160 2032 0
FLAG -1056 1616 VDD
FLAG -832 1744 0
FLAG -528 1728 0
FLAG -448 1728 0
FLAG -624 1776 0
FLAG 3888 1504 Vdd
FLAG 3888 1600 Vss
FLAG 3488 1408 0
FLAG 3632 1312 Vdd
FLAG 3568 1664 Vss
FLAG 3712 1664 0
FLAG 4224 1904 0
FLAG 3552 1712 ADG1236_IN
FLAG 5168 480 0
FLAG 5200 320 ADG1236_IN
FLAG 4880 1648 Vdd
FLAG 4880 1744 Vss
FLAG 5264 2080 0
FLAG 5168 2032 Vss
FLAG 5216 1600 Vdd
FLAG 5392 1696 External_Voutput
IOPIN 5392 1696 Out
FLAG 4976 1888 ADG5421F_IN
FLAG 5504 1888 Faultp
IOPIN 5504 1888 Out
FLAG 4912 1520 ADG5421F_S1
FLAG 4896 1824 ADG5421F_S2
FLAG 2928 592 0
FLAG 3136 592 0
FLAG 3152 464 Vdd5
FLAG 2944 464 Vss5
FLAG 3296 1824 BuffOut
FLAG 3968 1280 Deglout
FLAG 4688 1712 Filtout
FLAG -160 2016 Vdd
FLAG -160 2112 Vss
FLAG 4608 1904 0
FLAG 960 1920 _DacHold
FLAG 3488 1888 0
FLAG 3632 1792 Vdd
FLAG 3568 2144 Vss
FLAG 3712 2144 0
FLAG 3552 2192 ADG1236_IN
FLAG 3808 2032 0
FLAG 3808 2080 0
FLAG 3712 1280 Deglinv
FLAG 3888 1840 Deglninv
FLAG 4992 -64 ding
FLAG 4448 80 0
FLAG 4464 -64 tic1
FLAG 5424 80 0
FLAG 5424 -64 tic2
FLAG -656 1680 NR
FLAG 5440 2032 Vdd5
FLAG 5376 2080 0
FLAG 1952 1840 VDAC
FLAG 2064 2224 code
FLAG 2496 1872 _DacHold
FLAG 848 2032 0
FLAG 2976 1840 BuffIn
FLAG 2464 1840 VOUT
FLAG 2992 1904 glitch
FLAG 992 1840 Sine
FLAG 960 2112 0
FLAG 1680 1904 error
SYMBOL voltage 3136 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VsupPlus
SYMATTR Value {vdd}
SYMBOL voltage 2928 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VsupMinus
SYMATTR Value {vss}
SYMBOL voltage 4624 336 M0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value {ADG_IN}
SYMBOL cap 720 2048 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value 220pF
SYMBOL cap 736 1632 R0
SYMATTR InstName C7
SYMATTR Value 220pF
SYMBOL DAC\\AD5791 2208 1840 R0
SYMATTR InstName U3
SYMBOL voltage 4896 336 M0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 0V
SYMBOL cap -80 2032 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 0.1µF
SYMBOL voltage 3344 304 R0
WINDOW 0 58 26 Bottom 2
WINDOW 3 121 119 Bottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VsupRef
SYMATTR Value PWL(0 15 1 15 2 0)
SYMBOL misc\\LT5400-1 160 1840 M0
WINDOW 3 -122 163 Left 2
SYMATTR InstName U12
SYMBOL cap -544 1648 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL cap -464 1648 R0
SYMATTR InstName C2
SYMATTR Value 47µ
SYMBOL cap -640 1696 R0
SYMATTR InstName C9
SYMATTR Value 10µ
SYMBOL References\\LTC6655LN-5 -832 1648 R0
SYMATTR InstName U4
SYMBOL opamps\\ADA4077 -144 2000 R0
SYMATTR InstName U5
SYMBOL Switches\\ADG1236 3648 1472 R0
SYMATTR InstName U8a
SYMBOL res 4192 1728 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value {Rfilt}
SYMBOL cap 4592 1808 R0
SYMATTR InstName C8
SYMATTR Value 680p
SYMBOL res 4560 1696 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {Rfilt}
SYMBOL cap 4384 1584 R0
SYMATTR InstName C10
SYMATTR Value 27n
SYMBOL res 3568 1264 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 330
SYMBOL res 3920 1264 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 330
SYMBOL cap 3904 1728 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value 330pF
SYMBOL res 4256 1728 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value {Rfilt}
SYMBOL cap 4208 1856 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C16
SYMATTR Value 8.2n
SYMBOL cap 4784 1552 R0
SYMATTR InstName C5
SYMATTR Value 100pF
SYMBOL voltage 3136 480 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VsupPlus1
SYMATTR Value {vdd5}
SYMBOL voltage 2928 480 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VsupMinus1
SYMATTR Value {vss5}
SYMBOL voltage 960 1968 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 39 54 Left 2
WINDOW 3 24 96 Invisible 2
SYMATTR InstName V3
SYMATTR Value PULSE(0 1 {197m-500u} 100p 100p 100n 10u)
SYMBOL voltage 5168 336 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -231 190 Left 2
SYMATTR Value PULSE(0 5 {0.197-500200n} 1n 1n {10u-3u} 10u)
SYMATTR InstName V2
SYMBOL Switches\\ADG1236 3648 1952 R0
SYMATTR InstName U8b
SYMBOL res 3792 1904 R0
SYMATTR InstName R5
SYMATTR Value 165
SYMBOL cap 3792 2128 R0
SYMATTR InstName C12
SYMATTR Value 330pF
SYMBOL ind 5072 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 25.33nH
SYMBOL res 4640 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value 2
SYMBOL cap 4848 -48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C14
SYMATTR Value 100p
SYMBOL voltage 4448 -32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 10 126 Invisible 2
SYMATTR Value PULSE(0 1 {0.197-12.5n-500u} 100p 100p {10u-5n} 10u)
SYMATTR InstName V4
SYMBOL voltage 5424 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -370 115 Invisible 2
SYMATTR Value PULSE(0 5 {0.197-205n-500u} 1n 1n {10u-3u} 10u)
SYMATTR InstName V5
SYMBOL res 5040 1696 M0
WINDOW 0 3 35 Right 2
WINDOW 3 46 64 Left 2
SYMATTR InstName R1
SYMATTR Value 1Meg
SYMBOL res 5424 1888 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL cap 5392 1984 M0
SYMATTR InstName C3
SYMATTR Value 12pF
SYMBOL Switches\\ADG5421F 5216 1808 R0
SYMATTR InstName U6
SYMBOL OpAmps\\AD8676 624 1536 R0
SYMATTR InstName U8
SYMBOL OpAmps\\AD8676 3072 1760 R0
SYMATTR InstName U1
SYMBOL OpAmps\\AD8676 3904 1488 R0
SYMATTR InstName U2
SYMBOL OpAmps\\AD8676 4896 1632 R0
SYMATTR InstName U7
SYMBOL OpAmps\\AD8676 624 2144 M180
SYMATTR InstName U9
SYMBOL add_AD5791_glitch 2720 1872 R0
SYMATTR InstName X1
SYMATTR SpiceLine period = 32
SYMBOL digitizer 1120 1872 R0
SYMATTR InstName X2
SYMATTR SpiceLine Vlow=0
SYMATTR SpiceLine2 Vhigh=1
SYMATTR Value2 bits=20
SYMBOL voltage 848 1888 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -27 -97 Left 2
SYMATTR Value SINE(0 1 1k)
SYMATTR InstName V7
SYMBOL Range 1792 1840 R0
SYMATTR InstName X3
SYMATTR Value2 Vlow = 0
SYMATTR SpiceLine Vhigh = 1
SYMBOL INL 1344 1904 R0
WINDOW 3 8 59 Bottom 2
SYMATTR Value AD5791_INL
SYMATTR InstName X4
SYMBOL Add_INL 1552 1872 R0
SYMATTR InstName X5
SYMATTR Value bits = 20
TEXT -1176 656 Left 2 ;Lowest Noise DAC Reference
TEXT 2928 656 Left 2 ;Output Buffer
TEXT -328 656 Left 2 ;Reference Voltage buffer and inversion
TEXT 1376 696 Left 2 ;Equivalent Voltage \nRepresenting digital \nDAC input\nVdac=0V corresponds to \ncode 0x00000 (zero scale)\nVdac=1V corresponds to \ncode 0xFFFFF (full scale)\n \nThe DAC model is purely linear  \nwithout quantization and will \nrespond to voltages outside \nthe 0V to 1V range.\nThe A1 sampling block \nsimulates a staircase version \nof the continuous sine wave\n from VDAC_Input source. \nThis staircase emulates the \nusual zero order hold \ncharacterist of a DAC.The \nDAC ouput will show a \nstaircase. V6 serves as the \nAC and Noise analisys \nstimulus source.\n \n \nRight Click  VDAC_Input\nvoltage source to edit \nInput sinewave parameters.
TEXT -1192 160 Left 2 ;Simulation commands
TEXT 192 160 Left 2 ;Parameters
TEXT 2888 208 Left 2 ;Vdd=+15V Positive voltage supply for DAC, opamps and voltage reference\nVSS=-15V Negative Voltage supply for DAC and opamps
TEXT -1192 -88 Left 2 ;Release Date: 2022/06/30\nDescription: Sine Wave Voltage Generation - Performance Optimized
TEXT -1192 -128 Left 2 ;Simulation file notes
TEXT 2936 696 Left 2 ;The output buffer buffers the\n3.2k output resistance of the DAC\nto drive the deglitching stage with \na 330R input resistance.\nThe AD8675/6 opamp contributes \nvery little noise to the output, \nwith only 2.8nV/rtHz @ 1kHz.\nThe typical offset voltage is 12uV\nThe temperature offset drift is \nonly 0.6uV/oC maximum.\nThe input bias current is only\n2nA maximum is low enough that\nthe internal DAC 6.8k//6.8k=3.4k \nbias current cancellation resistor \ncan be left out of the inverting input\npath in favor of reduced overall noise.\nThe internal reference buffer\namplifier is disconnected from the \ninternal paralleled 6.8k resistors \nwith the RBUF pin set high at the \nDAC. Please keep in mind that the \nDAC has a purely linear model here.\nU3 and U11 are two halves of an\nAD8676 dual AD8675 opamp.\n \nRight-click on the symbol and follow \nthe data sheet link for more details.
TEXT 1944 688 Left 2 ;The maximum DAC Update Rate is \n(24 * 28ns)+T6+T14 + settling time\nThe settling time depends on the time \nconstant at DAC vout and on step size.\n \nThis can accomodate DAC update rates\nup to 1MHz. However each update \ninstant creates some distortion, so it is\nBetter to reduce the update rate for overall\nlower distortion. The /DacHold signal\ndrives the DAC with an update driving A1\nupdates the DAC input at 100kHz.\nA zero order hold attenuates the input as:\nH(Fin,Fs)=|(1-cos(2pi*Fin/Fs)\n                 -jsin(2pi*Fin/Fs))/j2pi*Fin/Fs|\nFin is the input frequency and Fs is the \nDAC update rate, both in Hz.\n \n \nRight-click on the symbol and follow \nthe data sheet link for more details.
TEXT 2880 160 Left 2 ;Power supplies
TEXT 184 224 Left 2 !.param vdd=15\n.param vss=-15\n.param vdd5=5\n.param vss5=-5\n.param vcc=5\n  \n.param VDAC_DC=1\n.param Rfilt=2k\n.param Fs=100k \n.param T=200/Fs\n.param Fin=2/T\n \n.param ADG_IN=vcc
TEXT 4792 656 Left 2 ;Output Pretection
TEXT 3864 160 Left 2 ;Control Signals
TEXT 400 696 Left 2 ;Kelvin Connected Reference Buffers \nwith Force/Sense ensure the full \nlinearity performance of the AD5791 \nDAC. Their Very low noise density is \nonly 2.8nV/rtHz @1kHz and very low \ndrift, only 0.6uV/oC maximum.\nAny noise present at the DAC \nreference pins will also show up at \nthe DAC vout. The reference noise \ncontribution is proportional to the \nDAC output voltage as a fraction of \neach reference voltage.\nThe AD8676 dual version of the \nAD8675 may be used here\n \nRight-click on the symbol and follow \nthe data sheet link for more details.
TEXT 1944 656 Left 2 ;AD5791 DAC
TEXT 3440 656 Left 2 ;Inverting Deglitcher stage
TEXT 920 656 Left 2 ;DAC input
TEXT 400 656 Left 2 ;Positive and Negative Reference Buffers
TEXT -320 696 Left 2 ;The U5 ADA4077-2 a high stability inverter to \ngenerate  the -5V reference voltage. \nThe output offset of the AD5791 is a direct function \nof VREFPS-VREFNS. The LT5400-1 network gives\nhigh stability and accuracy to the negative reference\nto maintain the DAC offset performance. The DAC\noffset is a direct function of the average between\nVrefP5V and VrefM5V.\n \nThe AD4077 amplifiers were chosen for their \nexcellent offset drift 0.25uV/oC max for A-grade. \n \nThe cap in parallel with the gain setting resistors \n make it possible to use relatively high value scaling \nresistors because their noise contribution is filtered \nout by the capt. \nThe DAC by itself generates only the noise of it's \ninternal resistor ladder impedance which is 3.2k \nwith a 7.5nV/RtHz noise density.\n \nRight-click on the symbol and follow \nthe data sheet link for more details.
TEXT -1184 688 Left 2 ;The LTC6655LN-5 in combination with the 1k-4.7uF (33Hz bw) \nfilter  take some time to settle after the start of conversion. \nTransient simulations need an an initial period of about 200ms \nfor the reference to stabilized before applying any signals \nelsewhere in the simiulation. \nDelaying the application of signals helps speed the simulation \ntime of the initial 200ms period.\nFor a more extensive simulation of the LTC6655LN-5, right-click \non the LTC6655LN-5 symbol, open the test jig and simulate the \nschematic. Noise is modeled in the LTC6655LN-5. The low \nfrequency noise is 0.6uVp-p between 0.1Hz and 10Hz and \n1uVrms between 10Hz and 1kHz.\nThe very low 2.5ppm/oC temperature drift of this reference \nkeeps any initial warmup settling tails to a minimum.\n \n \nRight-click on the symbol and follow \nthe data sheet links for more details.
TEXT 3440 696 Left 2 ;The deglitcher circuit is a sample-and-hold circuit \nthat tracks the DAC output when the DAC \noutput is settled, and goes into hold mode while\n the DAC transitions to the next level. This DAC \nlevel transition produces an analog glitch that \ncontains non-linear distortion that would \ncompromize Total Harmonic Distortion THD. \nThe diglichter hides this non-linear transition for \nthe best THD. There is still a small residual grlitch \nthat is created by the deglitcher but this glitch is \nconstant and contains no distortion products. \nThe second half of the ADG1236, U8b, provides\ncharge injection cancellation to obtain a nominal\nzero offset in this stage.The inverter topology \nwas chosen for lowest THD, with the switches \nalways operating near 0V.\n \nRight-click on symbol and follow the \ndata sheet link for more details.
TEXT 4792 696 Left 2 ;The ADG5421F provides output fault protection for the \nExternal_Vout pin. When no power supplies are present, the switch \nremains in the off condition, and the switch inputs are high\nimpedance.Under externally applied overvoltages exceeding Vdd or \nVss, thetwo Switches from Sx to Dx (11 Ohms)  open up, while the \nR1=1Meg shunt keeps the AD8675 operating normally in closed \nloop operation and the open-drain fault flag (FF) pulls to a logic low.\n \nIf the output protection switch is not desired, U9, R1 and C5 can be\neliminated, with R1 and C5 replaced by a wire. The External_Voutput\nwould be taken from the U10 output.\n \nRight-click on the symbol and follow\n the data sheet link for more details.
TEXT -1184 440 Left 2 ;.tran 0 {200m-T} {200m-T-2m} startup
TEXT -1192 192 Left 2 ;Only one simulation type runs with each simulation. \nRightk-click simulation commands below and esc \ndialog to disable simulation with the "Comment" \nbutton  or enable simulation with the "SPICE directive"\n button.\n \nRight click to edit parameters in the simulation dialog.
TEXT 1064 224 Left 2 ;---> set high positive analog supply voltage\n---> set high negative analog supply voltage\n---> set low positive analog supply voltage\n---> set low negative analog supply voltage\n---> set logic supply voltage \n \n---> set DAC equivalent DC input voltage. Used in .noise and .AC simulations. Midscale is at VDAC_DC=0.5V\n---> set resistor value for reconstruction/interpolation filter. This filter smooths the DAC step ouput\n---> set DAC update (sampling) frequency Fs in Hz\n---> set T time record from 200 samples of 1/Fs  for FFT analysis in the waveform viewer. T=200/Fs=2ms\n --> set input frequency for 2 cycles during T.   Fin=2cycles/T=1kHz. \n \n---> enable ADG5421F protection switch
TEXT 3888 280 Left 2 ;Control of output protectiion switch ADG5401F\n \nThe IN pin in the ADG5401F protection switch\nenables switch operation wtih a high level.\n \nThe POC pin in the ADG5401F controls\nthe switch between S and GND.\n \nRight-click on the symbol and follow the data \nsheet link for more details.
TEXT -1184 520 Left 2 ;.ac dec 100 1 1e9
TEXT -1184 576 Left 2 ;.noise V(External_Voutput) VDAC_Input dec 100 0.1 1e9
TEXT 208 200 Left 2 ;Supplies\n \n  \n \n \n \nSignal Chain \n \n \n \n \n  \nOutput Protection
TEXT 4072 656 Left 2 ;Interpolation Filter
TEXT 4072 696 Left 2 ;This 3rd order Sallen-Key filter serves as interpolation,\nor reconstruction, filter to turn the deglitched DAC \nsteps into a smooth sinewave.\nWith Rfilt=2k, the -3dB frequency is 17kHz and \nattenuates the 100kHz carrier by -50dB with negligible\nattenuation at the input frequency Fin=1kHz.\nThe presence of this filter does not make the deglitcher\ncircuit redundant, because the DAC ouput glitch has \ndistortion components within its glitch area that are \nharmonics of the sine wave, so they can't be filtered\nand must be deglitched.\nIn this topology of the Sallen-Key filter the U10 buffer\nis wired as a buffer throught the output protection \nswitch U9. C10=27nF may be alternatively wired to \nthe S output of the protection switch, but the \nprotection level is reduced at AC frequencies. At DC \nthe protection is the same. \nThe filter capacitors should be film types or COG/NPO\nceramic types. Other types of ceramic caps (X7R,X5R, \netc) produce very high levels of distortion.\n \n \n \nRight-click on the symbol and follow \nthe data sheet link for more details.
TEXT 4248 -128 Left 2 ;Convergence aids
TEXT 4512 0 Left 2 ;This side stimulus circuit produces underdamped 100MHz transients just \nbefore each critical timing edge in the main circuit. This serves to slow \ndown the timestep during transient simulation  in anticipation of crtical \nanalog steps in the main circuit to improve accuracy. This technique\nis a much faster alternative to setting the timestep to something like 1ns.
TEXT -1184 416 Left 2 !.tran 0 200m 197m startup
TEXT -1184 464 Left 2 ;.tran 0 200m {200m-T} startup
TEXT -472 408 Left 2 ;For saving full simulation. Not for FFT\nFor grounded input & filter settling. Not for FFT\nFor FFT. Save only the last T seconds of sim\n \nFor small signal AC\n \nFor noise simulation
TEXT -1184 608 Left 2 ;.step param VDAC_DC list 0 0.25 0.5 0.75 1
TEXT 1216 1728 Left 2 !.include AD5791_INL.cir
RECTANGLE Normal 5632 2240 4768 672 2
RECTANGLE Normal 2512 2240 1920 672 2
RECTANGLE Normal 3392 2240 2912 672 2
RECTANGLE Normal 880 2240 384 672 2
RECTANGLE Normal 1888 2240 912 672 2
RECTANGLE Normal 144 624 -1200 176 2
RECTANGLE Normal 2480 624 176 176 2
RECTANGLE Normal 3824 624 2880 176 2
RECTANGLE Normal -304 128 -1200 -112 2
RECTANGLE Normal 352 2240 -336 672 2
RECTANGLE Normal 5632 624 3856 176 2
RECTANGLE Normal 4032 2240 3424 672 2
RECTANGLE Normal -368 2240 -1200 672 2
RECTANGLE Normal 4736 2240 4064 672 2
RECTANGLE Normal 5632 128 4240 -112 2
